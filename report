# [Previous functions remain the same until the grouping logic]

    # First, filter for CVSS3 Base Score >= 7.0
    $highSeverity = $data | Where-Object {
        $score = $_.'CVSS3 Base Score'
        ![string]::IsNullOrWhiteSpace($score) -and 
        ($score -as [decimal]) -and 
        [decimal]$score -ge 7.0
    }

    # Create a hashtable to group by Host and Solution
    $groupedByHostAndSolution = @{}
    
    foreach ($entry in $highSeverity) {
        # Create a composite key using Host and Solution
        $compositeKey = "$($entry.Host)__|__$($entry.Solution)"
        
        if (!$groupedByHostAndSolution.ContainsKey($compositeKey)) {
            # Create new group
            $groupedByHostAndSolution[$compositeKey] = @{
                'CVSS3 Base Score' = $entry.'CVSS3 Base Score'
                'CVE' = @($entry.CVE)
                'Host' = $entry.Host
                'IP Address' = $entry.'IP Address'
                'Name' = $entry.Name
                'Synopsis' = $entry.Synopsis
                'Description' = $entry.Description
                'Solution' = $entry.Solution
                'See Also' = $entry.'See Also'
            }
        } else {
            # Add CVE to existing group if it's not already there
            if (!$groupedByHostAndSolution[$compositeKey]['CVE'].Contains($entry.CVE)) {
                $groupedByHostAndSolution[$compositeKey]['CVE'] += $entry.CVE
            }
        }
    }

    # Convert grouped data back to objects
    $filtered_data = $groupedByHostAndSolution.Values | ForEach-Object {
        [PSCustomObject]@{
            'CVSS3 Base Score' = $_.'CVSS3 Base Score'
            'CVE' = ($_.'CVE' -join '; ')
            'Host' = $_.Host
            'IP Address' = $_.'IP Address'
            'Name' = $_.Name
            'Synopsis' = $_.Synopsis
            'Description' = $_.Description
            'Solution' = $_.Solution
            'See Also' = $_.'See Also'
        }
    } | Sort-Object { $_.Host }, { [decimal]$_.'CVSS3 Base Score' } -Descending

# [Rest of the script remains the same]
